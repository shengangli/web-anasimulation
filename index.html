<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- Primary Meta Tags -->
    <title>ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« | é«˜é€ŸPPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—æ©Ÿ | ANAå…¬å¼ã‚ˆã‚Šç°¡å˜ãƒ»ä¾¿åˆ©</title>
    <meta name="title" content="ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« | é«˜é€ŸPPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—æ©Ÿ | ANAå…¬å¼ã‚ˆã‚Šç°¡å˜ãƒ»ä¾¿åˆ©">
    <meta name="description" content="ANAï¼ˆå…¨æ—¥ç©ºï¼‰ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰ã¨ãƒã‚¤ãƒ«ã‚’ç¬æ™‚ã«è¨ˆç®—ï¼ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šé¥ã‹ã«é«˜é€Ÿã§ä½¿ã„ã‚„ã™ã„ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚é‹è³ƒ1-13å®Œå…¨å¯¾å¿œã€æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—ã€PPåŠ¹ç‡åˆ†æã§æ™‚é–“ã‚’å¤§å¹…çŸ­ç¸®ã€‚AMCã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é”æˆã‚’åŠ¹ç‡çš„ã«ã‚µãƒãƒ¼ãƒˆã€‚">
    <meta name="keywords" content="ANA, å…¨æ—¥ç©º, ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆ, PPè¨ˆç®—, ãƒã‚¤ãƒ«è¨ˆç®—, AMC, ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹, ãƒ–ãƒ­ãƒ³ã‚º, ãƒ—ãƒ©ãƒãƒŠ, ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰, PPä¿®è¡Œ, é‹è³ƒ, æ­ä¹—ãƒã‚¤ãƒ³ãƒˆ, é«˜é€Ÿè¨ˆç®—, ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«, ANAå…¬å¼ã‚ˆã‚Šç°¡å˜, æ™‚é–“çŸ­ç¸®">
    <meta name="author" content="ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Japanese">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://anasimulator.com/">
    <meta property="og:title" content="ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« | é«˜é€ŸPPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—æ©Ÿ | ANAå…¬å¼ã‚ˆã‚Šç°¡å˜ãƒ»ä¾¿åˆ©">
    <meta property="og:description" content="ANAï¼ˆå…¨æ—¥ç©ºï¼‰ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰ã¨ãƒã‚¤ãƒ«ã‚’ç¬æ™‚ã«è¨ˆç®—ï¼ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šé¥ã‹ã«é«˜é€Ÿã§ä½¿ã„ã‚„ã™ã„ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚é‹è³ƒ1-13å®Œå…¨å¯¾å¿œã€æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—ã€PPåŠ¹ç‡åˆ†æã§æ™‚é–“ã‚’å¤§å¹…çŸ­ç¸®ã€‚">
    <meta property="og:image" content="https://anasimulator.com/og-image.jpg">
    <meta property="og:site_name" content="ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«">
    <meta property="og:locale" content="ja_JP">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://anasimulator.com/">
    <meta property="twitter:title" content="ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« | é«˜é€ŸPPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—æ©Ÿ | ANAå…¬å¼ã‚ˆã‚Šç°¡å˜ãƒ»ä¾¿åˆ©">
    <meta property="twitter:description" content="ANAï¼ˆå…¨æ—¥ç©ºï¼‰ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰ã¨ãƒã‚¤ãƒ«ã‚’ç¬æ™‚ã«è¨ˆç®—ï¼ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šé¥ã‹ã«é«˜é€Ÿã§ä½¿ã„ã‚„ã™ã„ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚é‹è³ƒ1-13å®Œå…¨å¯¾å¿œã€æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—ã€PPåŠ¹ç‡åˆ†æã§æ™‚é–“ã‚’å¤§å¹…çŸ­ç¸®ã€‚">
    <meta property="twitter:image" content="https://anasimulator.com/twitter-image.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://anasimulator.com/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/favicon/android-chrome-512x512.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«",
        "alternateName": "ANAãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆé«˜é€Ÿè¨ˆç®—æ©Ÿ",
        "description": "ANAï¼ˆå…¨æ—¥ç©ºï¼‰ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰ã¨ãƒã‚¤ãƒ«ã‚’ç¬æ™‚ã«è¨ˆç®—ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šé¥ã‹ã«é«˜é€Ÿã§ä½¿ã„ã‚„ã™ãã€é‹è³ƒ1-13å®Œå…¨å¯¾å¿œã€æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—ã€PPåŠ¹ç‡åˆ†æã§æ™‚é–“ã‚’å¤§å¹…çŸ­ç¸®ã€‚",
        "url": "https://ana-pp-calculator.com/",
        "applicationCategory": "TravelApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "JPY"
        },
        "featureList": [
            "é«˜é€Ÿãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰è¨ˆç®—",
            "ç¬æ™‚ãƒã‚¤ãƒ«è¨ˆç®—",
            "é‹è³ƒ1-13å®Œå…¨å¯¾å¿œ",
            "æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—",
            "PPåŠ¹ç‡åˆ†æ",
            "AMCã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€²æ—è¡¨ç¤º",
            "è¤‡æ•°ãƒ•ãƒ©ã‚¤ãƒˆä¸€æ‹¬å‡¦ç†",
            "å›½å†…ç·šãƒ»å›½éš›ç·šå¯¾å¿œ",
            "ANAå…¬å¼ã‚ˆã‚Šé«˜é€Ÿãƒ»ä¾¿åˆ©"
        ],
        "about": {
            "@type": "Thing",
            "name": "ANA ãƒã‚¤ãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ãƒ–",
            "description": "å…¨æ—¥ç©ºï¼ˆANAï¼‰ã®ãƒã‚¤ãƒ¬ãƒ¼ã‚¸ãƒ—ãƒ­ã‚°ãƒ©ãƒ "
        },
        "creator": {
            "@type": "Organization",
            "name": "ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«"
        },
        "dateModified": "2025-06-20",
        "inLanguage": "ja"
    }
    </script>
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#00234B">
    <meta name="msapplication-TileColor" content="#00234B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ANA PPé«˜é€Ÿè¨ˆç®—æ©Ÿ">
    <meta name="format-detection" content="telephone=no">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --ana-primary: #00234B;
            --ana-secondary: #005BAC;
            --ana-light-blue: #E6F2FF;
            --ana-red: #E60012;
            --ana-green: #00A651;
            --ana-orange: #FF6B00;
            --ana-gray: #666666;
            --ana-light-gray: #F5F5F5;
            --ana-border: #DDDDDD;
            --ana-text: #333333;
        }

        body {
            font-family: "ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ Pro W3", "Hiragino Kaku Gothic Pro", "ãƒ¡ã‚¤ãƒªã‚ª", Meiryo, Arial, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: var(--ana-text);
            background: #FFFFFF;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: var(--ana-primary);
            height: 70px;
            position: relative;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
        }

        /* Navigation */
        .navigation {
            background: var(--ana-secondary);
            height: 44px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            height: 100%;
            display: flex;
            align-items: center;
        }

        .nav-item {
            padding: 0 20px;
            height: 100%;
            display: flex;
            align-items: center;
            color: white;
            text-decoration: none;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            cursor: pointer;
            background: none;
            border-top: none;
            border-left: none;
            border-right: none;
            font-size: 14px;
            white-space: nowrap;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            border-bottom-color: white;
            background: rgba(255,255,255,0.1);
        }

        /* Main Content */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: calc(100vh - 200px);
        }

        .page-title {
            font-size: 22px;
            color: var(--ana-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--ana-secondary);
        }

        /* Sections */
        .section {
            background: white;
            border: 1px solid var(--ana-border);
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            border-radius: 8px;
        }

        .section-header {
            background: var(--ana-light-gray);
            padding: 15px 20px;
            border-bottom: 1px solid var(--ana-border);
            font-weight: bold;
            color: var(--ana-primary);
            border-radius: 8px 8px 0 0;
            font-size: 15px;
        }

        .section-content {
            padding: 20px;
        }

        /* Forms */
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-start;
        }

        /* Airport row and price row styling */
        .airport-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .price-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-start;
        }

        .form-group {
            flex: 1;
            min-width: 0;
        }

        .form-group.small {
            flex: 0.7;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--ana-text);
            font-size: 13px;
            height: 18px; /* Fixed height for consistent alignment */
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--ana-border);
            background: white;
            font-size: 14px;
            color: var(--ana-text);
            border-radius: 4px;
            height: 40px;
            line-height: 1.5;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            margin-bottom: 5px; /* Space for small text */
        }

        .form-select {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 20px;
            padding-right: 35px;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--ana-secondary);
            box-shadow: 0 0 0 2px rgba(0, 91, 172, 0.1);
        }

        /* Airport optgroup styling */
        .form-select optgroup {
            font-weight: bold;
            color: var(--ana-primary);
            background-color: var(--ana-light-gray);
            font-size: 13px;
        }

        .form-select optgroup option {
            font-weight: normal;
            color: var(--ana-text);
            background-color: white;
            padding-left: 20px;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            font-weight: bold;
            border-radius: 4px;
            text-align: center;
        }

        .btn-primary {
            background: var(--ana-secondary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--ana-primary);
        }

        .btn-add {
            background: var(--ana-light-blue);
            color: var(--ana-secondary);
            padding: 8px 16px;
            font-size: 13px;
            display: block;
            margin: 15px auto 0;
            width: fit-content;
        }

        .btn-add:hover {
            background: #CCE5FF;
        }

        .btn-remove {
            background: #fff5f5;
            color: var(--ana-red);
            padding: 6px 12px;
            font-size: 12px;
            border: 1px solid #fecaca;
        }

        .btn-remove:hover {
            background: #fef2f2;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Flight Calculator Enhancements */
        .flight-entry {
            border: 1px solid var(--ana-border);
            padding: 18px;
            margin-bottom: 15px;
            background: var(--ana-light-gray);
            border-radius: 8px;
        }

        .flight-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .flight-number {
            font-weight: bold;
            color: var(--ana-primary);
            font-size: 15px;
        }

        .route-type-indicator {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 10px;
        }

        .route-domestic {
            background: var(--ana-green);
            color: white;
        }

        .route-international {
            background: var(--ana-orange);
            color: white;
        }

        /* Enhanced Results */
        .results-dashboard {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .results-main {
            background: var(--ana-light-blue);
            border: 2px solid var(--ana-secondary);
            padding: 20px;
            border-radius: 8px;
        }

        .results-summary {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--ana-border);
        }

        .results-title {
            font-size: 18px;
            color: var(--ana-primary);
            margin-bottom: 15px;
            font-weight: bold;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .results-grid.no-price {
            grid-template-columns: 1fr;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: white;
            border: 1px solid var(--ana-border);
            border-radius: 6px;
        }

        .result-label {
            color: var(--ana-gray);
            font-size: 13px;
        }

        .result-value {
            font-weight: bold;
            color: var(--ana-primary);
            font-size: 16px;
        }

        .result-highlight {
            grid-column: 1 / -1;
            background: var(--ana-primary);
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 6px;
        }

        .result-highlight .result-value {
            color: white;
            font-size: 20px;
        }

        /* Efficiency Indicators */
        .efficiency-meter {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }

        .efficiency-bar {
            flex: 1;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            margin: 0 10px;
            position: relative;
            overflow: hidden;
        }

        .efficiency-fill {
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .efficiency-excellent { background: var(--ana-green); }
        .efficiency-good { background: var(--ana-secondary); }
        .efficiency-average { background: var(--ana-orange); }
        .efficiency-poor { background: var(--ana-red); }

        /* Status Progress Ring */
        .status-progress {
            text-align: center;
            margin-bottom: 20px;
        }

        .progress-ring {
            width: 100px;
            height: 100px;
            margin: 0 auto 10px;
        }

        /* Quick Templates */
        .template-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .template-btn {
            padding: 8px 16px;
            background: var(--ana-light-gray);
            color: var(--ana-text);
            border: 1px solid var(--ana-border);
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            min-width: 120px;
        }

        .template-btn:hover {
            background: var(--ana-light-blue);
            border-color: var(--ana-secondary);
        }

        /* Notice Box */
        .notice {
            background: #FFF9E6;
            border: 1px solid #FFD700;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
            color: var(--ana-text);
            border-radius: 6px;
            line-height: 1.6;
        }

        .notice-testing {
            background: #FFF2E6;
            border: 1px solid #FF9900;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
            color: var(--ana-text);
            border-radius: 6px;
            line-height: 1.6;
        }

        .notice-icon {
            color: #FF9900;
            margin-right: 5px;
        }

        /* Button Container */
        .button-container {
            text-align: center;
            margin: 30px 0;
        }

        .button-container .btn {
            margin: 0 10px 10px 0;
        }

        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            body {
                font-size: 13px;
            }

            /* Header adjustments */
            .header {
                height: 60px;
            }

            .header-content {
                padding: 0 15px;
            }

            .logo {
                font-size: 14px;
            }

            .logo svg {
                width: 28px;
                height: 28px;
            }

            /* Navigation */
            .navigation {
                height: 40px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }

            .navigation::-webkit-scrollbar {
                display: none;
            }

            .nav-content {
                padding: 0 10px;
                min-width: fit-content;
            }

            .nav-item {
                padding: 8px 15px;
                font-size: 13px;
                white-space: nowrap;
                height: 40px;
            }

            /* Main content */
            .main-container {
                padding: 15px;
                min-height: calc(100vh - 140px);
            }

            .page-title {
                font-size: 18px;
                margin-bottom: 15px;
            }

            /* Better mobile form organization */
            .form-row {
                margin-bottom: 15px;
            }

            /* Airport row - keep airports side by side on mobile */
            .airport-row {
                display: flex;
                gap: 10px;
                margin-bottom: 12px;
            }

            .airport-row .form-group {
                flex: 1;
            }

            /* Booking class - full width */
            .form-row:not(.airport-row):not(.price-row) {
                display: block;
            }

            /* Price row - side by side on mobile */
            .price-row {
                display: flex;
                gap: 10px;
                align-items: flex-start;
            }

            .price-row .form-group {
                flex: 1;
            }

            .price-row .form-group.small {
                flex: 0.6;
                min-width: 120px;
            }

            .form-group {
                margin-bottom: 0;
            }

            .form-group.small {
                flex: 0.6;
            }

            .form-label {
                font-size: 12px;
                margin-bottom: 4px;
                font-weight: 600;
            }

            .form-input,
            .form-select {
                font-size: 16px; /* Prevent zoom on iOS */
                padding: 10px 12px;
                height: 44px;
            }

            .form-select {
                padding-right: 40px;
            }

            /* Sections */
            .section {
                margin-bottom: 15px;
                border-radius: 6px;
            }

            .section-header {
                padding: 12px 15px;
                font-size: 14px;
            }

            .section-content {
                padding: 15px;
            }

            /* Flight entries */
            .flight-entry {
                padding: 15px;
                margin-bottom: 12px;
                border-radius: 6px;
            }

            .flight-entry-header {
                margin-bottom: 12px;
                align-items: center;
                gap: 10px;
            }

            .flight-number {
                font-size: 14px;
                flex: 1;
            }

            /* Buttons */
            .btn {
                padding: 12px 20px;
                font-size: 14px;
                width: 100%;
                margin-bottom: 10px;
                height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .btn-add {
                width: auto;
                margin: 15px auto 0;
                padding: 10px 20px;
                height: auto;
            }

            .btn-remove {
                padding: 8px 12px;
                font-size: 11px;
                width: auto;
                height: auto;
                margin-bottom: 0;
            }

            /* Template buttons */
            .template-buttons {
                flex-direction: column;
                gap: 8px;
                margin-bottom: 15px;
            }

            .template-btn {
                padding: 10px 16px;
                font-size: 13px;
                flex: none;
                min-width: 0;
                height: 40px;
                border-radius: 6px;
            }

            /* Results */
            .results-dashboard {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .results-main,
            .results-summary {
                padding: 15px;
            }

            .results-title {
                font-size: 16px;
                margin-bottom: 12px;
            }

            .results-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .result-item {
                padding: 12px;
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
                min-height: auto;
            }

            .result-label {
                font-size: 11px;
                color: var(--ana-gray);
            }

            .result-value {
                font-size: 16px;
                margin-top: 2px;
            }

            .result-highlight {
                padding: 15px;
            }

            .result-highlight .result-value {
                font-size: 18px;
            }

            /* Efficiency meter */
            .efficiency-meter {
                margin: 12px 0;
                font-size: 11px;
            }

            .efficiency-bar {
                height: 6px;
                margin: 0 8px;
            }

            /* Status progress */
            .status-progress {
                margin-bottom: 15px;
            }

            .progress-ring {
                width: 80px;
                height: 80px;
            }

            /* Notice */
            .notice, .notice-testing {
                padding: 12px;
                font-size: 12px;
                margin-bottom: 15px;
                line-height: 1.5;
            }

            /* Button container */
            .button-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
                margin: 20px 0;
            }

            .button-container .btn {
                width: 100%;
                max-width: 320px;
                margin: 0;
            }

            /* Advanced options */
            #advanced-options {
                margin-top: 10px;
                padding: 12px;
            }
        }

        /* Extra small devices - Stack airports vertically if very narrow */
        @media (max-width: 480px) {
            .header {
                height: 55px;
            }

            .logo span {
                font-size: 13px;
            }

            .logo svg {
                width: 24px;
                height: 24px;
            }

            .nav-item {
                padding: 8px 12px;
                font-size: 12px;
            }

            .page-title {
                font-size: 16px;
            }

            .main-container {
                padding: 12px;
            }

            .section-content {
                padding: 12px;
            }

            .flight-entry {
                padding: 12px;
            }

            .results-main,
            .results-summary {
                padding: 12px;
            }

            .template-btn {
                padding: 8px 12px;
                font-size: 12px;
                height: 36px;
            }

            /* Stack airports vertically on very small screens */
            .airport-row {
                flex-direction: column;
                gap: 12px;
            }

            /* Keep price row side by side even on very small screens */
            .price-row {
                flex-direction: row;
                gap: 8px;
            }

            .price-row .form-group.small {
                min-width: 110px;
            }
        }

        /* Touch-friendly adjustments */
        @media (hover: none) and (pointer: coarse) {
            .btn,
            .form-input,
            .form-select,
            .nav-item,
            .template-btn {
                min-height: 44px;
            }
        }

        /* Prevent horizontal scroll */
        html, body {
            overflow-x: hidden;
            max-width: 100vw;
        }

        .main-container,
        .header-content,
        .nav-content {
            max-width: 100%;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" role="banner">
        <div class="header-content">
            <a href="#" class="logo" aria-label="ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ« ãƒ›ãƒ¼ãƒ ">
                <svg width="32" height="32" viewBox="0 0 40 40" fill="white" aria-hidden="true">
                    <circle cx="20" cy="20" r="18" stroke="white" stroke-width="2" fill="none"/>
                    <text x="50%" y="50%" text-anchor="middle" dy=".3em" fill="white" font-size="12" font-weight="bold">ANA</text>
                </svg>
                <span>æˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«</span>
            </a>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navigation" role="navigation" aria-label="ãƒ¡ã‚¤ãƒ³ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³">
        <div class="nav-content">
            <button class="nav-item active" onclick="switchTab('trip-calculator')" aria-current="page">æ—…è¡Œè¨ˆç®—æ©Ÿ</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-container" role="main">
        <!-- Breadcrumbs -->
        <nav aria-label="ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ" style="margin-bottom: 10px;">
            <ol style="list-style: none; padding: 0; margin: 0; font-size: 12px; color: var(--ana-gray);">
                <li style="display: inline;"><a href="#" style="color: var(--ana-gray); text-decoration: none;">ãƒ›ãƒ¼ãƒ </a> &gt; </li>
                <li style="display: inline; color: var(--ana-primary);">ANA PPãƒ»ãƒã‚¤ãƒ«é«˜é€Ÿè¨ˆç®—æ©Ÿ</li>
            </ol>
        </nav>
        
        <!-- Trip Calculator Tab -->
        <article id="trip-calculator" class="tab-content active">
            <header>
                <h1 class="page-title">ğŸš€ ANAæ—…è¡Œè¨ˆç®—æ©Ÿ - ANAå…¬å¼ã‚ˆã‚Šé«˜é€Ÿã§ä¾¿åˆ©ãªPPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—</h1>
                <p style="font-size: 14px; color: var(--ana-gray); margin-bottom: 20px;">
                    <strong>âš¡ ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šåœ§å€’çš„ã«é«˜é€Ÿï¼</strong> ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰ã¨ãƒã‚¤ãƒ«ã‚’ç¬æ™‚ã«è¨ˆç®—ã€‚é‹è³ƒ1-13å®Œå…¨å¯¾å¿œã€æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—ã€PPåŠ¹ç‡åˆ†æã§æ™‚é–“ã‚’å¤§å¹…çŸ­ç¸®ã€‚AMCã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é”æˆã®æœ€çŸ­ãƒ«ãƒ¼ãƒˆã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚
                </p>
            </header>
            
            <section class="notice-testing" role="region" aria-labelledby="testing-notice">
                <h2 id="testing-notice" style="display: none;">ãƒ†ã‚¹ãƒˆç‰ˆã«é–¢ã™ã‚‹æ³¨æ„äº‹é …</h2>
                <span class="notice-icon" aria-hidden="true">ğŸ§ª</span>
                <strong>ã€ãƒ†ã‚¹ãƒˆç‰ˆã€‘è¨ˆç®—ç²¾åº¦ã«ã¤ã„ã¦:</strong> ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ç¾åœ¨ãƒ†ã‚¹ãƒˆæ®µéšã®ãŸã‚ã€è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã«ä¸æ­£ç¢ºãªéƒ¨åˆ†ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
                <br>â€¢ è·é›¢ãƒ‡ãƒ¼ã‚¿ãƒ»ç©ç®—ç‡ãƒ»æ­ä¹—ãƒã‚¤ãƒ³ãƒˆãªã©ã®æ¤œè¨¼ã‚’ç¶™ç¶šä¸­
                <br>â€¢ ã‚ˆã‚Šæ­£ç¢ºãªè¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é–‹ç™ºä¸­
                <br>â€¢ <strong>é‡è¦ãªPPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—ã¯å¿…ãšANAå…¬å¼ã‚µã‚¤ãƒˆã§æœ€çµ‚ç¢ºèªã‚’ãŠé¡˜ã„ã—ã¾ã™</strong>
                <br>â€¢ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚„ä¸å…·åˆå ±å‘Šã‚’ãŠå¾…ã¡ã—ã¦ã„ã¾ã™ï¼ˆä¸‹éƒ¨ã®ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã‚ˆã‚Šï¼‰
            </section>

            <section class="notice" role="region" aria-labelledby="important-notice">
                <h2 id="important-notice" style="display: none;">ä½¿ç”¨ä¸Šã®æ³¨æ„äº‹é …</h2>
                <span class="notice-icon" aria-hidden="true">âš ï¸</span>
                <strong>ä½¿ç”¨ä¸Šã®æ³¨æ„äº‹é …:</strong> ã“ã®è¨ˆç®—æ©Ÿã¯æ¦‚ç®—ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã§ã™ã€‚
                <br>â€¢ è·é›¢ãƒ‡ãƒ¼ã‚¿: å¤§åœè·é›¢ã®è¿‘ä¼¼å€¤ã‚’ä½¿ç”¨ï¼ˆANAå…¬å¼è·é›¢ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰
                <br>â€¢ PPè¨ˆç®—: ANAå…¬å¼ã®è¨ˆç®—å¼ï¼ˆè·é›¢Ã—ç©ç®—ç‡Ã—è·¯ç·šå€ç‡+æ­ä¹—ãƒã‚¤ãƒ³ãƒˆï¼‰ã«åŸºã¥ãã€æ­ä¹—ãƒã‚¤ãƒ³ãƒˆã‚‚å«ã‚ã¦è¨ˆç®—
                <br>â€¢ æ­ä¹—ãƒã‚¤ãƒ³ãƒˆ: é‹è³ƒ1-3,5=400ptã€é‹è³ƒ6=200ptã€é‹è³ƒ4,7-13=0ptï¼ˆANAå…¬å¼ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãï¼‰
                <br>â€¢ ãƒã‚¤ãƒ«è¨ˆç®—: ANAå…¬å¼ã®ç©ç®—ç‡ã«åŸºã¥ã„ã¦ã„ã¾ã™ãŒã€å®Ÿéš›ã®ç©ç®—ã¨ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™
            </section>

            <!-- Quick Templates -->
            <section class="template-buttons" role="region" aria-labelledby="quick-templates">
                <h2 id="quick-templates" style="display: none;">ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</h2>
                <button class="template-btn" onclick="loadTemplate('business')" aria-label="å‡ºå¼µãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’èª­ã¿è¾¼ã‚€">ğŸ“Š å‡ºå¼µãƒ‘ã‚¿ãƒ¼ãƒ³</button>
                <button class="template-btn" onclick="loadTemplate('leisure')" aria-label="ä¼‘æš‡æ—…è¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’èª­ã¿è¾¼ã‚€">ğŸ–ï¸ ä¼‘æš‡æ—…è¡Œ</button>
                <button class="template-btn" onclick="loadTemplate('pp-run')" aria-label="PPä¿®è¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’èª­ã¿è¾¼ã‚€">ğŸƒ PPä¿®è¡Œ</button>
                <button class="template-btn" onclick="loadTemplate('international')" aria-label="å›½éš›ç·šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’èª­ã¿è¾¼ã‚€">âœˆï¸ å›½éš›ç·š</button>
            </section>

            <section class="section">
                <header class="section-header">
                    <h2>ãƒ•ãƒ©ã‚¤ãƒˆè©³ç´°å…¥åŠ›</h2>
                </header>
                <div class="section-content">
                    <div id="flights-container">
                        <!-- First Flight Entry -->
                        <div class="flight-entry">
                            <div class="flight-entry-header">
                                <span class="flight-number">ãƒ•ãƒ©ã‚¤ãƒˆ 1</span>
                                <button class="btn btn-remove" onclick="removeFlight(this)">å‰Šé™¤</button>
                            </div>
                            <div class="form-row airport-row">
                                <div class="form-group">
                                    <label class="form-label">å‡ºç™ºç©ºæ¸¯</label>
                                    <select class="form-select from-airport" onchange="updateRouteInfo(this)">
                                        <option value="">å‡ºç™ºç©ºæ¸¯ã‚’é¸æŠ...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">åˆ°ç€ç©ºæ¸¯</label>
                                    <select class="form-select to-airport" onchange="updateRouteInfo(this)">
                                        <option value="">åˆ°ç€ç©ºæ¸¯ã‚’é¸æŠ...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label booking-class-label">äºˆç´„ã‚¯ãƒ©ã‚¹</label>
                                    <select class="form-select booking-class">
                                        <option value="">ã¾ãšç©ºæ¸¯ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row price-row">
                                <div class="form-group">
                                    <label class="form-label">1åŒºé–“ãƒã‚±ãƒƒãƒˆä¾¡æ ¼ (ç¨è¾¼) - ã‚ªãƒ—ã‚·ãƒ§ãƒ³</label>
                                    <input type="number" class="form-input ticket-price" placeholder="ä¾¡æ ¼ã‚’å…¥åŠ›ã™ã‚‹ã¨PPåŠ¹ç‡ã‚‚è¨ˆç®—ã•ã‚Œã¾ã™" min="0">
                                    <small style="color: var(--ana-gray); font-size: 11px;">å†† (ç‰‡é“ä¾¡æ ¼) - ç©ºç™½ã§ã‚‚PPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—å¯èƒ½</small>
                                </div>
                                <div class="form-group small">
                                    <label class="form-label">å¾€å¾©ãƒ»è¤‡æ•°åŒºé–“</label>
                                    <select class="form-select trip-multiplier">
                                        <option value="1">ç‰‡é“ (1åŒºé–“)</option>
                                        <option value="2">å¾€å¾© (2åŒºé–“)</option>
                                        <option value="3">3åŒºé–“</option>
                                        <option value="4">4åŒºé–“</option>
                                        <option value="5">5åŒºé–“</option>
                                        <option value="6">6åŒºé–“ä»¥ä¸Š</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-add" onclick="addFlight()">+ ãƒ•ãƒ©ã‚¤ãƒˆã‚’è¿½åŠ </button>
                </div>
            </div>

            <section class="section">
                <header class="section-header">
                    <h2>åŸºæœ¬è¨­å®š</h2>
                </header>
                <div class="section-content">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ç¾åœ¨ã®AMCã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                            <select class="form-select" id="current-status">
                                <option value="none">AMCãƒ¡ãƒ³ãƒãƒ¼</option>
                                <option value="bronze">ãƒ–ãƒ­ãƒ³ã‚ºã‚µãƒ¼ãƒ“ã‚¹ (+30%)</option>
                                <option value="platinum">ãƒ—ãƒ©ãƒãƒŠã‚µãƒ¼ãƒ“ã‚¹ (+50%)</option>
                                <option value="diamond">ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ (+100%)</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Advanced Options (Collapsible) -->
                    <div style="margin-top: 20px;">
                        <button type="button" class="btn" style="background: var(--ana-light-gray); color: var(--ana-text); font-size: 13px; padding: 8px 16px;" onclick="toggleAdvancedOptions()">
                            <span id="advanced-toggle">â–¶</span> è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³
                        </button>
                        <div id="advanced-options" style="display: none; margin-top: 15px; padding: 15px; background: var(--ana-light-gray); border-radius: 6px;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">ç¾åœ¨ã®PPæ®‹é«˜ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</label>
                                    <input type="number" class="form-input" id="current-pp" placeholder="0" value="0">
                                    <small style="color: var(--ana-gray); font-size: 11px;">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€²æ—è¨ˆç®—ã«ä½¿ç”¨</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <div class="button-container" role="region" aria-labelledby="calculation-controls">
                <h2 id="calculation-controls" style="display: none;">è¨ˆç®—å®Ÿè¡Œ</h2>
                <button class="btn btn-primary" onclick="calculateTrip()" aria-describedby="calculation-description">
                    âš¡ é«˜é€Ÿåˆ†æã‚’å®Ÿè¡Œ
                </button>
                <p id="calculation-description" style="display: none;">ãƒ•ãƒ©ã‚¤ãƒˆæƒ…å ±ã‚’åŸºã«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆã¨ãƒã‚¤ãƒ«ã‚’è¨ˆç®—ã—ã¾ã™</p>
                <button class="btn" onclick="testCalculation()" style="background: var(--ana-light-gray); color: var(--ana-text);" aria-label="è¨ˆç®—æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ">
                    ğŸ”§ ãƒ†ã‚¹ãƒˆ
                </button>
            </div>

            <section id="trip-results" style="display: none;" role="region" aria-labelledby="results-title" aria-live="polite">
                <div class="results-dashboard">
                    <div class="results-main">
                        <h2 class="results-title">ğŸ“ˆ ãƒˆãƒªãƒƒãƒ—åˆ†æçµæœ</h2>
                        <div class="results-grid">
                            <div class="result-item">
                                <span class="result-label">ç²å¾—PP</span>
                                <span class="result-value" id="total-pp">0</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ç²å¾—ãƒã‚¤ãƒ«</span>
                                <span class="result-value" id="total-miles">0</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ç·è²»ç”¨</span>
                                <span class="result-value" id="total-cost">Â¥0</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">PPåŠ¹ç‡</span>
                                <span class="result-value" id="pp-efficiency">0 PP/Â¥1000</span>
                            </div>
                            <div class="result-highlight">
                                <span class="result-label">ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©•ä¾¡</span>
                                <div class="efficiency-meter">
                                    <span style="font-size: 12px;">ä½åŠ¹ç‡</span>
                                    <div class="efficiency-bar">
                                        <div class="efficiency-fill" id="efficiency-bar"></div>
                                    </div>
                                    <span style="font-size: 12px;">é«˜åŠ¹ç‡</span>
                                </div>
                                <div id="efficiency-rating" style="margin-top: 10px; font-weight: bold;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="results-summary">
                        <h3 class="results-title">ğŸ¯ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€²æ—</h3>
                        <div class="status-progress">
                            <div class="progress-ring">
                                <svg width="100" height="100" viewBox="0 0 100 100">
                                    <circle cx="50" cy="50" r="40" stroke="#e5e7eb" stroke-width="8" fill="transparent"/>
                                    <circle cx="50" cy="50" r="40" stroke="var(--ana-secondary)" stroke-width="8" fill="transparent"
                                            stroke-dasharray="251.2" stroke-dashoffset="251.2" id="progress-circle"
                                            style="transition: stroke-dashoffset 0.5s ease;"/>
                                    <text x="50" y="50" text-anchor="middle" dy="0.3em" font-size="14" font-weight="bold" fill="var(--ana-primary)" id="progress-percent">0%</text>
                                </svg>
                            </div>
                            <div id="status-text">æ¬¡ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¾ã§</div>
                        </div>
                        <div id="status-recommendations">
                            <!-- Dynamic recommendations will be inserted here -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- FAQ Section for SEO -->
            <section class="section" style="margin-top: 40px;">
                <header class="section-header">
                    <h2>ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰</h2>
                </header>
                <div class="section-content">
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: var(--ana-primary); font-size: 14px; margin-bottom: 8px;">Q: ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ANAå…¬å¼ã‚µã‚¤ãƒˆã¨ã©ã†é•ã„ã¾ã™ã‹ï¼Ÿ</h3>
                        <p style="font-size: 13px; line-height: 1.5; margin-bottom: 15px;">A: ANAå…¬å¼ã‚µã‚¤ãƒˆã§ã¯1åŒºé–“ãšã¤ã—ã‹è¨ˆç®—ã§ããšæ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ãŒã€å½“ãƒ„ãƒ¼ãƒ«ã§ã¯è¤‡æ•°ãƒ•ãƒ©ã‚¤ãƒˆã‚’ä¸€æ‹¬ã§ç¬æ™‚ã«è¨ˆç®—ã€‚PPåŠ¹ç‡åˆ†æã‚„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€²æ—ã‚‚åŒæ™‚ã«è¡¨ç¤ºã—ã€åœ§å€’çš„ã«é«˜é€Ÿã§ä¾¿åˆ©ã§ã™ã€‚</p>
                        
                        <h3 style="color: var(--ana-primary); font-size: 14px; margin-bottom: 8px;">Q: ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆï¼ˆPPï¼‰ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</h3>
                        <p style="font-size: 13px; line-height: 1.5; margin-bottom: 15px;">A: ANAãƒã‚¤ãƒ¬ãƒ¼ã‚¸ã‚¯ãƒ©ãƒ–ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç²å¾—ã«å¿…è¦ãªãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚ãƒ•ãƒ©ã‚¤ãƒˆãƒã‚¤ãƒ«ã¨ã¯åˆ¥ã«ç©ç®—ã•ã‚Œã€ãƒ–ãƒ­ãƒ³ã‚ºï¼ˆ30,000PPï¼‰ã€ãƒ—ãƒ©ãƒãƒŠï¼ˆ50,000PPï¼‰ã€ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ï¼ˆ100,000PPï¼‰ã®é”æˆã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p>
                        
                        <h3 style="color: var(--ana-primary); font-size: 14px; margin-bottom: 8px;">Q: æ­ä¹—ãƒã‚¤ãƒ³ãƒˆã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</h3>
                        <p style="font-size: 13px; line-height: 1.5; margin-bottom: 15px;">A: å›½å†…ç·šã®ç‰¹å®šé‹è³ƒã§ç²å¾—ã§ãã‚‹è¿½åŠ ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚é‹è³ƒ1-3,5ã§400ãƒã‚¤ãƒ³ãƒˆã€é‹è³ƒ6ã§200ãƒã‚¤ãƒ³ãƒˆã€ãã®ä»–ã¯0ãƒã‚¤ãƒ³ãƒˆãŒä»˜ä¸ã•ã‚Œã¾ã™ã€‚</p>
                        
                        <h3 style="color: var(--ana-primary); font-size: 14px; margin-bottom: 8px;">Q: é‹è³ƒ1-13ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</h3>
                        <p style="font-size: 13px; line-height: 1.5; margin-bottom: 15px;">A: ANAã®å›½å†…ç·šé‹è³ƒç¨®åˆ¥ç•ªå·ã§ã™ã€‚é‹è³ƒ1ãŒãƒ—ãƒ¬ãƒŸã‚¢ãƒ é‹è³ƒï¼ˆ150%ï¼‰ã€é‹è³ƒ7ãŒSUPER VALUEï¼ˆ75%ï¼‰ãªã©ã€ãã‚Œãã‚Œç•°ãªã‚‹ç©ç®—ç‡ã¨æ­ä¹—ãƒã‚¤ãƒ³ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
                        
                        <h3 style="color: var(--ana-primary); font-size: 14px; margin-bottom: 8px;">Q: PPåŠ¹ç‡ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ</h3>
                        <p style="font-size: 13px; line-height: 1.5;">A: 1,000å††ã‚ãŸã‚Šã«ç²å¾—ã§ãã‚‹ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆæ•°ã§ã™ã€‚PPä¿®è¡Œã§ã¯é‡è¦ãªæŒ‡æ¨™ã§ã€é«˜ã„åŠ¹ç‡ã®ãƒ«ãƒ¼ãƒˆã‚’é¸ã¶ã“ã¨ã§ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’é”æˆã§ãã¾ã™ã€‚</p>
                    </div>
                </div>
            </section>
        </article>
    </main>

    <!-- Footer -->
    <footer style="background: var(--ana-light-gray); border-top: 1px solid var(--ana-border); margin-top: 40px; padding: 30px 20px 20px;">
        <div style="max-width: 1400px; margin: 0 auto;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-bottom: 20px;">
                <div>
                    <h3 style="color: var(--ana-primary); font-size: 16px; margin-bottom: 15px;">ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦</h3>
                    <p style="font-size: 13px; line-height: 1.5; color: var(--ana-gray);">
                        ANAï¼ˆå…¨æ—¥ç©ºï¼‰ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒã‚¤ãƒ³ãƒˆã¨ãƒã‚¤ãƒ«ã‚’<strong>ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šåœ§å€’çš„ã«é«˜é€Ÿ</strong>ã§æ­£ç¢ºã«è¨ˆç®—ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚è¤‡æ•°ãƒ•ãƒ©ã‚¤ãƒˆä¸€æ‹¬è¨ˆç®—ã€PPåŠ¹ç‡åˆ†æã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€²æ—è¡¨ç¤ºã§æ™‚é–“ã‚’å¤§å¹…çŸ­ç¸®ã—ã€AMCã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é”æˆã‚’åŠ¹ç‡çš„ã«ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
                    </p>
                </div>
                <div>
                    <h3 style="color: var(--ana-primary); font-size: 16px; margin-bottom: 15px;">å¯¾å¿œæ©Ÿèƒ½</h3>
                    <ul style="list-style: none; padding: 0; font-size: 13px; line-height: 1.7; color: var(--ana-gray);">
                        <li>âš¡ ANAå…¬å¼ã‚ˆã‚Šé«˜é€Ÿè¨ˆç®—</li>
                        <li>âœˆï¸ å›½å†…ç·šãƒ»å›½éš›ç·šPPè¨ˆç®—</li>
                        <li>ğŸ¯ é‹è³ƒ1-13å®Œå…¨å¯¾å¿œ</li>
                        <li>ğŸ“Š æ­ä¹—ãƒã‚¤ãƒ³ãƒˆè‡ªå‹•è¨ˆç®—</li>
                        <li>ğŸ’° PPåŠ¹ç‡åˆ†æ</li>
                        <li>ğŸ“ˆ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é€²æ—è¡¨ç¤º</li>
                        <li>ğŸƒ PPä¿®è¡Œãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°</li>
                        <li>ğŸ”„ è¤‡æ•°ãƒ•ãƒ©ã‚¤ãƒˆä¸€æ‹¬å‡¦ç†</li>
                    </ul>
                </div>
                <div>
                    <h3 style="color: var(--ana-primary); font-size: 16px; margin-bottom: 15px;">ãŠå•ã„åˆã‚ã›ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</h3>
                    <p style="font-size: 13px; line-height: 1.5; color: var(--ana-gray); margin-bottom: 15px;">
                        è¨ˆç®—çµæœã®ä¸å…·åˆå ±å‘Šã€æ©Ÿèƒ½æ”¹å–„ã®ã”ææ¡ˆã€ã”è³ªå•ãªã©ã€ãŠæ°—è»½ã«ãŠå¯„ã›ãã ã•ã„ã€‚
                    </p>
                    <a href="https://docs.google.com/forms/d/e/1FAIpQLSefkeAmPPZgZyHH-jye_hxon_VE1wa744wqnUEZ52qBd9WwRw/viewform?usp=dialog" style="display: inline-block; background: var(--ana-secondary); color: white; padding: 8px 16px; border-radius: 4px; text-decoration: none; font-size: 13px; font-weight: bold;">
                        ğŸ“§ ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ 
                    </a>
                    <div style="margin-top: 10px;">
                        <h4 style="color: var(--ana-primary); font-size: 14px; margin-bottom: 8px;">é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</h4>
                        <div style="font-size: 12px; line-height: 1.5; color: var(--ana-gray);">
                            <span style="display: inline-block; background: white; padding: 4px 8px; margin: 2px; border-radius: 12px; border: 1px solid var(--ana-border);">ANA PPé«˜é€Ÿè¨ˆç®—</span>
                            <span style="display: inline-block; background: white; padding: 4px 8px; margin: 2px; border-radius: 12px; border: 1px solid var(--ana-border);">ãƒã‚¤ãƒ«ç¬æ™‚è¨ˆç®—</span>
                            <span style="display: inline-block; background: white; padding: 4px 8px; margin: 2px; border-radius: 12px; border: 1px solid var(--ana-border);">AMCã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</span>
                            <span style="display: inline-block; background: white; padding: 4px 8px; margin: 2px; border-radius: 12px; border: 1px solid var(--ana-border);">PPä¿®è¡ŒåŠ¹ç‡åŒ–</span>
                            <span style="display: inline-block; background: white; padding: 4px 8px; margin: 2px; border-radius: 12px; border: 1px solid var(--ana-border);">å…¬å¼ã‚ˆã‚Šä¾¿åˆ©</span>
                            <span style="display: inline-block; background: white; padding: 4px 8px; margin: 2px; border-radius: 12px; border: 1px solid var(--ana-border);">æ™‚é–“çŸ­ç¸®ãƒ„ãƒ¼ãƒ«</span>
                        </div>
                    </div>
                </div>
            </div>
            <div style="border-top: 1px solid var(--ana-border); padding-top: 20px; text-align: center; font-size: 12px; color: var(--ana-gray);">
                <p>Â© 2025 ANAæˆ¦ç•¥çš„PPãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«. ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ANAï¼ˆå…¨æ—¥ç©ºï¼‰ã®å…¬å¼ãƒ„ãƒ¼ãƒ«ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                <p><strong>ANAå…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Šé«˜é€Ÿãƒ»ä¾¿åˆ©</strong>ã§ã™ãŒã€æ­£ç¢ºãªæƒ…å ±ã¯å¿…ãšANAå…¬å¼ã‚µã‚¤ãƒˆã§ã”ç¢ºèªãã ã•ã„ã€‚</p>
            </div>
        </div>
    </footer>

    <!-- Contact Form Modal (Hidden by default) -->
    <div id="contact-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 8px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <h3 style="color: var(--ana-primary); margin-bottom: 20px;">ãŠå•ã„åˆã‚ã›ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</h3>
            <form id="contact-form" onsubmit="submitContactForm(event)">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">ãŠå•ã„åˆã‚ã›ç¨®åˆ¥</label>
                    <select style="width: 100%; padding: 8px; border: 1px solid var(--ana-border); border-radius: 4px;">
                        <option value="bug">è¨ˆç®—çµæœã®ä¸å…·åˆå ±å‘Š</option>
                        <option value="feature">æ©Ÿèƒ½æ”¹å–„ãƒ»è¿½åŠ è¦æœ›</option>
                        <option value="question">ä½¿ã„æ–¹ã«é–¢ã™ã‚‹è³ªå•</option>
                        <option value="other">ãã®ä»–</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</label>
                    <input type="email" style="width: 100%; padding: 8px; border: 1px solid var(--ana-border); border-radius: 4px;" placeholder="è¿”ä¿¡ã‚’ã”å¸Œæœ›ã®å ´åˆã¯ã”å…¥åŠ›ãã ã•ã„">
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">å†…å®¹</label>
                    <textarea style="width: 100%; padding: 8px; border: 1px solid var(--ana-border); border-radius: 4px; height: 120px; resize: vertical;" placeholder="è©³ç´°ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚ä¸å…·åˆã®å ´åˆã¯ã€ä½¿ç”¨ã—ãŸãƒ«ãƒ¼ãƒˆã‚„è¨­å®šã‚‚ãŠæ•™ãˆã„ãŸã ã‘ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™ã€‚" required></textarea>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="closeContactForm()" style="padding: 10px 20px; background: var(--ana-light-gray); color: var(--ana-text); border: 1px solid var(--ana-border); border-radius: 4px; cursor: pointer;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button type="submit" style="padding: 10px 20px; background: var(--ana-secondary); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">é€ä¿¡</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Enhanced route distances based on IATA TPM data
        const routeDistances = {
            // Major International Routes from Japan
            'NRT-LAX': 5451, 'NRT-JFK': 6737, 'NRT-LHR': 5956, 'NRT-SIN': 3312, 'NRT-SYD': 4863, 'NRT-FRA': 5928,
            'NRT-CDG': 6012, 'NRT-AMS': 5863, 'NRT-MAD': 6734, 'NRT-FCO': 6125, 'NRT-ZUR': 5890, 'NRT-VIE': 5623,
            'HND-ORD': 6262, 'HND-LAX': 5440, 'HND-SFO': 5130, 'HND-SEA': 4782, 'HND-DFW': 6456, 'HND-IAH': 6804,
            'KIX-SFO': 5358, 'KIX-LAX': 5481, 'KIX-HNL': 3856, 'KIX-SIN': 3243, 'KIX-BKK': 2869, 'KIX-ICN': 540,
            'NGO-SEA': 4782, 'NGO-SFO': 5116, 'NGO-HNL': 3853, 'FUK-HNL': 3853, 'FUK-ICN': 541, 'FUK-SIN': 3312,
            'NRT-BKK': 2869, 'NRT-SFO': 5130, 'NRT-SEA': 4782, 'NRT-HKG': 1807, 'NRT-ICN': 758, 'NRT-PEK': 1313,
            'NRT-PVG': 1094, 'NRT-TPE': 1313, 'NRT-MNL': 1864, 'NRT-KUL': 3312, 'NRT-CGK': 3632, 'NRT-BOM': 4163,
            'NRT-DEL': 3665, 'NRT-DXB': 5063, 'NRT-DOH': 4953, 'NRT-IST': 5623, 'NRT-CAI': 5890, 'NRT-JNB': 8912,
            'HND-ICN': 720, 'HND-PVG': 1090, 'HND-TPE': 1310, 'HND-HKG': 1800, 'HND-SIN': 3308, 'HND-BKK': 2865,
            'KIX-HKG': 1463, 'KIX-TPE': 976, 'KIX-PVG': 754, 'KIX-PEK': 983, 'KIX-MNL': 1520, 'KIX-GUM': 1225,
            'NGO-ICN': 598, 'NGO-TPE': 1153, 'NGO-PVG': 934, 'NGO-HKG': 1647, 'NGO-GUM': 1405, 'NGO-SIN': 3152,
            'CTS-ICN': 600, 'CTS-TPE': 1353, 'CTS-HKG': 1847, 'CTS-SIN': 3352, 'CTS-BKK': 3069, 'CTS-GUM': 1605,
            'OKA-ICN': 618, 'OKA-TPE': 613, 'OKA-HKG': 881, 'OKA-SIN': 2450, 'OKA-BKK': 2167, 'OKA-MNL': 758,
            
            // Additional International Routes
            'NRT-HNL': 3853, 'HND-HNL': 3850, 'NRT-GUM': 1560, 'HND-GUM': 1555,
            'ITM-ICN': 520, 'ITM-TPE': 960, 'ITM-HKG': 1450, 'ITM-PVG': 740, 'ITM-SIN': 3220,
            'FUK-PVG': 550, 'FUK-TPE': 750, 'FUK-HKG': 1100, 'FUK-BKK': 2580, 'FUK-MNL': 1580,
            
            // Domestic routes - All major combinations
            'NRT-HND': 20, 'NRT-KIX': 280, 'NRT-ITM': 280, 'NRT-NGO': 180, 'NRT-CTS': 510, 'NRT-FUK': 565, 'NRT-OKA': 984,
            'HND-KIX': 280, 'HND-ITM': 280, 'HND-NGO': 180, 'HND-CTS': 510, 'HND-FUK': 565, 'HND-OKA': 984,
            'KIX-NGO': 120, 'KIX-CTS': 730, 'KIX-FUK': 285, 'KIX-OKA': 704, 'KIX-ITM': 20,
            'ITM-NGO': 110, 'ITM-CTS': 720, 'ITM-FUK': 280, 'ITM-OKA': 700,
            'NGO-CTS': 610, 'NGO-FUK': 405, 'NGO-OKA': 804,
            'CTS-FUK': 1175, 'CTS-OKA': 1494,
            'FUK-OKA': 419
        };

        // Airport data organized by regions
        const airportsByRegion = {
            'æ—¥æœ¬å›½å†…': {
                'NRT': 'æ±äº¬æˆç”° (NRT)',
                'HND': 'æ±äº¬ç¾½ç”° (HND)', 
                'KIX': 'å¤§é˜ªé–¢è¥¿ (KIX)',
                'ITM': 'å¤§é˜ªä¼Šä¸¹ (ITM)',
                'NGO': 'åå¤å±‹ä¸­éƒ¨ (NGO)',
                'CTS': 'æœ­å¹Œæ–°åƒæ­³ (CTS)',
                'FUK': 'ç¦å²¡ (FUK)',
                'OKA': 'æ²–ç¸„é‚£è¦‡ (OKA)'
            },
            'ã‚¢ã‚¸ã‚¢ãƒ»å¤ªå¹³æ´‹': {
                'ICN': 'ã‚½ã‚¦ãƒ«ä»å· (ICN)',
                'PEK': 'åŒ—äº¬é¦–éƒ½ (PEK)',
                'PVG': 'ä¸Šæµ·æµ¦æ± (PVG)',
                'TPE': 'å°åŒ—æ¡ƒåœ’ (TPE)',
                'HKG': 'é¦™æ¸¯ (HKG)',
                'SIN': 'ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ« (SIN)',
                'BKK': 'ãƒãƒ³ã‚³ã‚¯ (BKK)',
                'MNL': 'ãƒãƒ‹ãƒ© (MNL)',
                'SYD': 'ã‚·ãƒ‰ãƒ‹ãƒ¼ (SYD)',
                'GUM': 'ã‚°ã‚¢ãƒ  (GUM)'
            },
            'åŒ—ç±³': {
                'LAX': 'ãƒ­ã‚µãƒ³ã‚¼ãƒ«ã‚¹ (LAX)',
                'SFO': 'ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ (SFO)',
                'SEA': 'ã‚·ã‚¢ãƒˆãƒ« (SEA)',
                'JFK': 'ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯ JFK (JFK)',
                'ORD': 'ã‚·ã‚«ã‚´ ã‚ªãƒ˜ã‚¢ (ORD)',
                'DFW': 'ãƒ€ãƒ©ã‚¹ (DFW)',
                'IAH': 'ãƒ’ãƒ¥ãƒ¼ã‚¹ãƒˆãƒ³ (IAH)',
                'HNL': 'ãƒ›ãƒãƒ«ãƒ« (HNL)'
            },
            'ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘': {
                'LHR': 'ãƒ­ãƒ³ãƒ‰ãƒ³ ãƒ’ãƒ¼ã‚¹ãƒ­ãƒ¼ (LHR)',
                'CDG': 'ãƒ‘ãƒª CDG (CDG)',
                'FRA': 'ãƒ•ãƒ©ãƒ³ã‚¯ãƒ•ãƒ«ãƒˆ (FRA)',
                'AMS': 'ã‚¢ãƒ ã‚¹ãƒ†ãƒ«ãƒ€ãƒ  (AMS)',
                'MAD': 'ãƒãƒ‰ãƒªãƒ¼ãƒ‰ (MAD)',
                'FCO': 'ãƒ­ãƒ¼ãƒ (FCO)',
                'ZUR': 'ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ’ (ZUR)',
                'VIE': 'ã‚¦ã‚£ãƒ¼ãƒ³ (VIE)',
                'IST': 'ã‚¤ã‚¹ã‚¿ãƒ³ãƒ–ãƒ¼ãƒ« (IST)'
            },
            'ä¸­æ±ãƒ»ãã®ä»–': {
                'DXB': 'ãƒ‰ãƒã‚¤ (DXB)',
                'DOH': 'ãƒ‰ãƒ¼ãƒ (DOH)',
                'BOM': 'ãƒ ãƒ³ãƒã‚¤ (BOM)',
                'DEL': 'ãƒ‡ãƒªãƒ¼ (DEL)'
            }
        };

        // Create flat airport names lookup
        const airportNames = {};
        Object.keys(airportsByRegion).forEach(region => {
            Object.assign(airportNames, airportsByRegion[region]);
        });

        // ==========================================
        // ANA BOOKING CLASS DATA STORAGE LOCATION
        // ==========================================
        // This section contains ALL fare data used in calculations
        
        // ANA Domestic Numbered Fare System (é‹è³ƒ1-13) - Based on OFFICIAL ANA data
        // Source: ANAå›½å†…ç·šåˆ©ç”¨é‹è³ƒä¸€è¦§è¡¨ - Exact rates and boarding points
        const domesticClassData = {
            // é‹è³ƒ1-3: Premium/Full Fares (400 Boarding Points)
            '1': { rate: 1.5, name: 'é‹è³ƒ1 ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é‹è³ƒ (150%) +400pt', category: 'premium', ppMultiplier: 1.5, boardingPoints: 400 },
            '2': { rate: 1.25, name: 'é‹è³ƒ2 VALUE PREMIUM 3/æ ªä¸»å„ªå¾… (125%) +400pt', category: 'premium', ppMultiplier: 1.25, boardingPoints: 400 },
            '3': { rate: 1.0, name: 'é‹è³ƒ3 ANA FLEX/ãƒ“ã‚¸ãƒã‚¹ãã£ã· (100%) +400pt', category: 'full', ppMultiplier: 1.0, boardingPoints: 400 },
            
            // é‹è³ƒ4: Special Full Fare (0 Boarding Points) - CORRECTED
            '4': { rate: 1.0, name: 'é‹è³ƒ4 å„ç¨®ã‚¢ã‚¤ãã£ã· (100%) +0pt', category: 'full', ppMultiplier: 1.0, boardingPoints: 0 },
            
            // é‹è³ƒ5: VALUE Fares (400 Boarding Points) - CORRECTED  
            '5': { rate: 0.75, name: 'é‹è³ƒ5 VALUE 1/3/7/æ ªä¸»å„ªå¾… (75%) +400pt', category: 'value', ppMultiplier: 0.75, boardingPoints: 400 },
            
            // é‹è³ƒ6: VALUE TRANSIT (200 Boarding Points)
            '6': { rate: 0.75, name: 'é‹è³ƒ6 VALUE TRANSIT (75%) +200pt', category: 'value', ppMultiplier: 0.75, boardingPoints: 200 },
            
            // é‹è³ƒ7-8: Discount Fares (0 Boarding Points)
            '7': { rate: 0.75, name: 'é‹è³ƒ7 SUPER VALUE 21/28/45 (75%) +0pt', category: 'discount', ppMultiplier: 0.75, boardingPoints: 0 },
            '8': { rate: 0.5, name: 'é‹è³ƒ8 ã‚¹ãƒãƒ¼ãƒˆU25/ã‚·ãƒ‹ã‚¢ç©ºå‰² (50%) +0pt', category: 'discount', ppMultiplier: 0.5, boardingPoints: 0 },
            
            // é‹è³ƒ9-13: International domestic segments (0 Boarding Points)
            '9': { rate: 1.5, name: 'é‹è³ƒ9 å›½éš›ç·šå›½å†…åŒºé–“ F/A (150%) +0pt', category: 'intl-domestic', ppMultiplier: 1.5, boardingPoints: 0 },
            '10': { rate: 1.0, name: 'é‹è³ƒ10 å›½éš›ç·šå›½å†…åŒºé–“ Y/B/M (100%) +0pt', category: 'intl-domestic', ppMultiplier: 1.0, boardingPoints: 0 },
            '11': { rate: 0.7, name: 'é‹è³ƒ11 å›½éš›ç·šå›½å†…åŒºé–“ U/H/Q (70%) +0pt', category: 'intl-domestic', ppMultiplier: 0.7, boardingPoints: 0 },
            '12': { rate: 0.5, name: 'é‹è³ƒ12 å›½éš›ç·šå›½å†…åŒºé–“ V/W/S (50%) +0pt', category: 'intl-domestic', ppMultiplier: 0.5, boardingPoints: 0 },
            '13': { rate: 0.3, name: 'é‹è³ƒ13 å›½éš›ç·šå›½å†…åŒºé–“ L/K (30%) +0pt', category: 'intl-domestic', ppMultiplier: 0.3, boardingPoints: 0 }
        };

        // ANA International Booking Classes (A-Z System) - No Boarding Points for International
        const internationalClassData = {
            // Economy Classes
            'Y': { rate: 1.0, name: 'Y (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»æ™®é€šé‹è³ƒ 100%)', category: 'economy', ppMultiplier: 1.0, boardingPoints: 0 },
            'B': { rate: 0.7, name: 'B (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»å‰²å¼•é‹è³ƒ 70%)', category: 'economy', ppMultiplier: 0.7, boardingPoints: 0 },
            'M': { rate: 0.7, name: 'M (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»å‰²å¼•é‹è³ƒ 70%)', category: 'economy', ppMultiplier: 0.7, boardingPoints: 0 },
            'U': { rate: 0.5, name: 'U (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»æ ¼å®‰é‹è³ƒ 50%)', category: 'economy', ppMultiplier: 0.5, boardingPoints: 0 },
            'H': { rate: 0.5, name: 'H (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»æ ¼å®‰é‹è³ƒ 50%)', category: 'economy', ppMultiplier: 0.5, boardingPoints: 0 },
            'Q': { rate: 0.5, name: 'Q (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»æ ¼å®‰é‹è³ƒ 50%)', category: 'economy', ppMultiplier: 0.5, boardingPoints: 0 },
            'V': { rate: 0.3, name: 'V (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'W': { rate: 0.3, name: 'W (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'S': { rate: 0.3, name: 'S (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'T': { rate: 0.3, name: 'T (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'L': { rate: 0.3, name: 'L (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'G': { rate: 0.3, name: 'G (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'K': { rate: 0.3, name: 'K (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            'E': { rate: 0.3, name: 'E (ã‚¨ã‚³ãƒãƒŸãƒ¼ãƒ»è¶…æ ¼å®‰ 30%)', category: 'economy', ppMultiplier: 0.3, boardingPoints: 0 },
            
            // Premium Economy Classes
            'P': { rate: 1.3, name: 'P (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼ 130%)', category: 'premium-economy', ppMultiplier: 1.3, boardingPoints: 0 },
            'O': { rate: 1.3, name: 'O (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼ 130%)', category: 'premium-economy', ppMultiplier: 1.3, boardingPoints: 0 },
            'N': { rate: 1.3, name: 'N (ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼ 130%)', category: 'premium-economy', ppMultiplier: 1.3, boardingPoints: 0 },
            
            // Business Classes
            'J': { rate: 1.5, name: 'J (ãƒ“ã‚¸ãƒã‚¹ã‚¯ãƒ©ã‚¹ 150%)', category: 'business', ppMultiplier: 1.5, boardingPoints: 0 },
            'C': { rate: 1.5, name: 'C (ãƒ“ã‚¸ãƒã‚¹ã‚¯ãƒ©ã‚¹ 150%)', category: 'business', ppMultiplier: 1.5, boardingPoints: 0 },
            'D': { rate: 1.25, name: 'D (ãƒ“ã‚¸ãƒã‚¹ãƒ»å‰²å¼• 125%)', category: 'business', ppMultiplier: 1.25, boardingPoints: 0 },
            'I': { rate: 1.25, name: 'I (ãƒ“ã‚¸ãƒã‚¹ãƒ»å‰²å¼• 125%)', category: 'business', ppMultiplier: 1.25, boardingPoints: 0 },
            'Z': { rate: 1.25, name: 'Z (ãƒ“ã‚¸ãƒã‚¹ãƒ»å‰²å¼• 125%)', category: 'business', ppMultiplier: 1.25, boardingPoints: 0 },
            
            // First Class
            'F': { rate: 2.0, name: 'F (ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ 200%)', category: 'first', ppMultiplier: 2.0, boardingPoints: 0 },
            'A': { rate: 2.0, name: 'A (ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ 200%)', category: 'first', ppMultiplier: 2.0, boardingPoints: 0 }
        };

        // Status bonus rates (for miles earning)
        const statusBonus = {
            'none': 0, 'bronze': 0.3, 'platinum': 0.5, 'diamond': 1.0
        };

        // Route ratio for Premium Points calculation
        const routeRatio = {
            'domestic': 2.0,           // Japan domestic = 2x
            'asia': 1.5,              // Japan-Asia = 1.5x  
            'international': 1.0       // Other international = 1x
        };

        let flightCounter = 1;

        // Contact form functions
        function openContactForm() {
            document.getElementById('contact-modal').style.display = 'flex';
        }

        function closeContactForm() {
            document.getElementById('contact-modal').style.display = 'none';
        }

        function submitContactForm(event) {
            event.preventDefault();
            alert('ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚é€ä¿¡æ©Ÿèƒ½ã¯ç¾åœ¨æº–å‚™ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚');
            closeContactForm();
        }

        // Test function
        function testCalculation() {
            console.log('Test calculation function called');
            alert('è¨ˆç®—ãƒœã‚¿ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ï¼å‡ºç™ºãƒ»åˆ°ç€ç©ºæ¸¯ã¨äºˆç´„ã‚¯ãƒ©ã‚¹ã‚’é¸æŠã—ã¦ã‹ã‚‰ã€Œé«˜é€Ÿåˆ†æã‚’å®Ÿè¡Œã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚');
        }

        // Toggle advanced options
        function toggleAdvancedOptions() {
            const options = document.getElementById('advanced-options');
            const toggle = document.getElementById('advanced-toggle');
            
            if (options.style.display === 'none') {
                options.style.display = 'block';
                toggle.textContent = 'â–¼';
            } else {
                options.style.display = 'none';
                toggle.textContent = 'â–¶';
            }
        }

        // Initialize airports with regional grouping
        function initializeAirports() {
            const selects = document.querySelectorAll('.from-airport, .to-airport');
            
            selects.forEach(select => {
                const isFrom = select.classList.contains('from-airport');
                select.innerHTML = isFrom ? '<option value="">å‡ºç™ºç©ºæ¸¯ã‚’é¸æŠ...</option>' : '<option value="">åˆ°ç€ç©ºæ¸¯ã‚’é¸æŠ...</option>';
                
                // Add airports by region
                Object.keys(airportsByRegion).forEach(regionName => {
                    const airports = airportsByRegion[regionName];
                    
                    // Add region header
                    const regionOption = document.createElement('optgroup');
                    regionOption.label = regionName;
                    select.appendChild(regionOption);
                    
                    // Add airports in this region
                    Object.keys(airports).forEach(code => {
                        const option = document.createElement('option');
                        option.value = code;
                        option.textContent = airports[code];
                        regionOption.appendChild(option);
                    });
                });
            });
        }

        // Template loading
        function loadTemplate(type) {
            const container = document.getElementById('flights-container');
            container.innerHTML = '';
            flightCounter = 0;

            const templates = {
                business: [
                    { from: 'HND', to: 'ICN', class: 'J', price: 180000 },
                    { from: 'ICN', to: 'HND', class: 'J', price: 180000 }
                ],
                leisure: [
                    { from: 'NRT', to: 'HNL', class: 'Y', price: 85000 }
                ],
                'pp-run': [
                    { from: 'HND', to: 'OKA', class: '5', price: 30000 },
                    { from: 'OKA', to: 'HND', class: '5', price: 30000 }
                ],
                international: [
                    { from: 'NRT', to: 'LAX', class: 'W', price: 280000 }
                ]
            };

            templates[type].forEach(flight => {
                addFlight();
                const lastFlight = container.lastElementChild;
                lastFlight.querySelector('.from-airport').value = flight.from;
                lastFlight.querySelector('.to-airport').value = flight.to;
                updateRouteInfo(lastFlight.querySelector('.from-airport'));
                lastFlight.querySelector('.booking-class').value = flight.class;
                lastFlight.querySelector('.ticket-price').value = flight.price;
            });
        }

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Flight management
        function addFlight() {
            flightCounter++;
            const container = document.getElementById('flights-container');
            const newFlight = document.createElement('div');
            newFlight.className = 'flight-entry';
            newFlight.innerHTML = `
                <div class="flight-entry-header">
                    <span class="flight-number">ãƒ•ãƒ©ã‚¤ãƒˆ ${flightCounter}</span>
                    <button class="btn btn-remove" onclick="removeFlight(this)">å‰Šé™¤</button>
                </div>
                <div class="form-row airport-row">
                    <div class="form-group">
                        <label class="form-label">å‡ºç™ºç©ºæ¸¯</label>
                        <select class="form-select from-airport" onchange="updateRouteInfo(this)">
                            <option value="">å‡ºç™ºç©ºæ¸¯ã‚’é¸æŠ...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">åˆ°ç€ç©ºæ¸¯</label>
                        <select class="form-select to-airport" onchange="updateRouteInfo(this)">
                            <option value="">åˆ°ç€ç©ºæ¸¯ã‚’é¸æŠ...</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label booking-class-label">äºˆç´„ã‚¯ãƒ©ã‚¹</label>
                        <select class="form-select booking-class">
                            <option value="">ã¾ãšç©ºæ¸¯ã‚’é¸æŠã—ã¦ãã ã•ã„</option>
                        </select>
                    </div>
                </div>
                <div class="form-row price-row">
                    <div class="form-group">
                        <label class="form-label">1åŒºé–“ãƒã‚±ãƒƒãƒˆä¾¡æ ¼ (ç¨è¾¼) - ã‚ªãƒ—ã‚·ãƒ§ãƒ³</label>
                        <input type="number" class="form-input ticket-price" placeholder="ä¾¡æ ¼ã‚’å…¥åŠ›ã™ã‚‹ã¨PPåŠ¹ç‡ã‚‚è¨ˆç®—ã•ã‚Œã¾ã™" min="0">
                        <small style="color: var(--ana-gray); font-size: 11px;">å†† (ç‰‡é“ä¾¡æ ¼) - ç©ºç™½ã§ã‚‚PPãƒ»ãƒã‚¤ãƒ«è¨ˆç®—å¯èƒ½</small>
                    </div>
                    <div class="form-group small">
                        <label class="form-label">å¾€å¾©ãƒ»è¤‡æ•°åŒºé–“</label>
                        <select class="form-select trip-multiplier">
                            <option value="1">ç‰‡é“ (1åŒºé–“)</option>
                            <option value="2">å¾€å¾© (2åŒºé–“)</option>
                            <option value="3">3åŒºé–“</option>
                            <option value="4">4åŒºé–“</option>
                            <option value="5">5åŒºé–“</option>
                            <option value="6">6åŒºé–“ä»¥ä¸Š</option>
                        </select>
                    </div>
                </div>
            `;
            container.appendChild(newFlight);
            
            // Initialize airport dropdowns with regional grouping
            const fromSelect = newFlight.querySelector('.from-airport');
            const toSelect = newFlight.querySelector('.to-airport');
            
            [fromSelect, toSelect].forEach(select => {
                // Add airports by region
                Object.keys(airportsByRegion).forEach(regionName => {
                    const airports = airportsByRegion[regionName];
                    
                    // Add region header
                    const regionOption = document.createElement('optgroup');
                    regionOption.label = regionName;
                    select.appendChild(regionOption);
                    
                    // Add airports in this region
                    Object.keys(airports).forEach(code => {
                        const option = document.createElement('option');
                        option.value = code;
                        option.textContent = airports[code];
                        regionOption.appendChild(option);
                    });
                });
            });
        }

        function removeFlight(button) {
            button.closest('.flight-entry').remove();
        }

        // Route information update
        function updateRouteInfo(select) {
            const flight = select.closest('.flight-entry');
            const from = flight.querySelector('.from-airport').value;
            const to = flight.querySelector('.to-airport').value;
            const classSelect = flight.querySelector('.booking-class');
            const classLabel = flight.querySelector('.booking-class-label');
            
            if (from && to) {
                const routeType = isInternational(from, to) ? 'international' : 'domestic';
                
                // Update booking class label
                if (routeType === 'domestic') {
                    classLabel.textContent = 'äºˆç´„ã‚¯ãƒ©ã‚¹ (é‹è³ƒã‚¿ã‚¤ãƒ—)';
                } else {
                    classLabel.textContent = 'äºˆç´„ã‚¯ãƒ©ã‚¹ (Booking Class)';
                }
                
                // Update booking class options based on route type
                updateBookingClassOptions(classSelect, routeType);
            } else {
                classSelect.innerHTML = '<option value="">ã¾ãšç©ºæ¸¯ã‚’é¸æŠã—ã¦ãã ã•ã„</option>';
                classLabel.textContent = 'äºˆç´„ã‚¯ãƒ©ã‚¹';
            }
        }

        // Update booking class options based on route type
        function updateBookingClassOptions(select, routeType) {
            const currentValue = select.value;
            select.innerHTML = '';
            
            // Add default option
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'äºˆç´„ã‚¯ãƒ©ã‚¹ã‚’é¸æŠ...';
            select.appendChild(defaultOption);
            
            // Choose the appropriate class data based on route type
            const classData = routeType === 'domestic' ? domesticClassData : internationalClassData;
            
            // Group classes by category
            const categories = {};
            
            if (routeType === 'domestic') {
                // Domestic numbered fare system (é‹è³ƒ1-13) with boarding points - CORRECTED
                categories.premium = { name: '--- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é‹è³ƒ (400pt) ---', classes: [] };
                categories.full = { name: '--- æ™®é€šé‹è³ƒ (400pt/0pt) ---', classes: [] };
                categories.value = { name: '--- VALUEé‹è³ƒ (400pt/200pt) ---', classes: [] };
                categories.discount = { name: '--- å‰²å¼•é‹è³ƒ (0pt) ---', classes: [] };
                categories['intl-domestic'] = { name: '--- å›½éš›ç·šå›½å†…åŒºé–“ (0pt) ---', classes: [] };
            } else {
                categories.economy = { name: '--- ã‚¨ã‚³ãƒãƒŸãƒ¼ã‚¯ãƒ©ã‚¹ ---', classes: [] };
                categories['premium-economy'] = { name: '--- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¨ã‚³ãƒãƒŸãƒ¼ ---', classes: [] };
                categories.business = { name: '--- ãƒ“ã‚¸ãƒã‚¹ã‚¯ãƒ©ã‚¹ ---', classes: [] };
                categories.first = { name: '--- ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ ---', classes: [] };
            }
            
            // Group classes
            Object.keys(classData).forEach(classCode => {
                const classInfo = classData[classCode];
                
                if (categories[classInfo.category]) {
                    categories[classInfo.category].classes.push({
                        code: classCode,
                        name: classInfo.name,
                        rate: classInfo.rate
                    });
                }
            });
            
            // Add options to select
            Object.keys(categories).forEach(categoryKey => {
                const category = categories[categoryKey];
                if (category.classes.length > 0) {
                    // Add class options grouped
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = category.name;
                    select.appendChild(optgroup);
                    
                    // Sort by rate (highest first)
                    category.classes.sort((a, b) => b.rate - a.rate);
                    
                    category.classes.forEach(classInfo => {
                        const option = document.createElement('option');
                        option.value = classInfo.code;
                        option.textContent = classInfo.name;
                        optgroup.appendChild(option);
                    });
                }
            });
            
            // Restore previous value if still valid
            if (currentValue && select.querySelector(`option[value="${currentValue}"]`)) {
                select.value = currentValue;
            }
        }

        // Utility functions
        function getDistance(from, to) {
            const route = `${from}-${to}`;
            const reverse = `${to}-${from}`;
            return routeDistances[route] || routeDistances[reverse] || 0;
        }

        function estimateDistance(from, to) {
            const domesticAirports = ['NRT', 'HND', 'KIX', 'ITM', 'NGO', 'CTS', 'FUK', 'OKA'];
            const isDomestic = domesticAirports.includes(from) && domesticAirports.includes(to);
            
            if (isDomestic) {
                if ((from === 'CTS' || to === 'CTS') && (from === 'OKA' || to === 'OKA')) return 1494;
                if (from === 'CTS' || to === 'CTS') return 700;
                if (from === 'OKA' || to === 'OKA') return 800;
                return 300;
            } else {
                const asiaAirports = ['ICN', 'PEK', 'PVG', 'TPE', 'HKG', 'SIN', 'BKK', 'MNL'];
                const europeAirports = ['LHR', 'CDG', 'FRA', 'AMS', 'MAD', 'FCO', 'ZUR', 'VIE'];
                const americasAirports = ['LAX', 'SFO', 'SEA', 'JFK', 'ORD', 'DFW', 'IAH', 'HNL'];
                
                if (asiaAirports.includes(from) || asiaAirports.includes(to)) return 2000;
                if (europeAirports.includes(from) || europeAirports.includes(to)) return 5900;
                if (americasAirports.includes(from) || americasAirports.includes(to)) return 5500;
                return 3500;
            }
        }

        function isInternational(from, to) {
            const domesticAirports = ['NRT', 'HND', 'KIX', 'ITM', 'NGO', 'CTS', 'FUK', 'OKA'];
            return !(domesticAirports.includes(from) && domesticAirports.includes(to));
        }

        function getRouteRatio(from, to) {
            if (!isInternational(from, to)) {
                return routeRatio.domestic; // 2.0 for domestic
            }
            
            const asiaAirports = ['ICN', 'PEK', 'PVG', 'TPE', 'HKG', 'SIN', 'BKK', 'MNL'];
            if (asiaAirports.includes(from) || asiaAirports.includes(to)) {
                return routeRatio.asia; // 1.5 for Asia
            }
            
            return routeRatio.international; // 1.0 for other international
        }

        // Corrected calculation functions based on ANA official system
        function calculatePP(distance, classCode, routeType, from, to) {
            const classData = routeType === 'domestic' ? domesticClassData : internationalClassData;
            const classInfo = classData[classCode];
            
            if (!classInfo) return 0;
            
            // ANA Premium Points formula: Basic segment mileage Ã— Mileage accrual rate Ã— Route Ratio + Boarding Points
            const routeRatioValue = getRouteRatio(from, to);
            const basePP = Math.floor(distance * classInfo.ppMultiplier * routeRatioValue);
            
            // Add boarding points (only for domestic flights, international flights don't get boarding points)
            const boardingPoints = routeType === 'domestic' ? classInfo.boardingPoints : 0;
            
            console.log(`PP Calculation: ${distance} miles Ã— ${classInfo.ppMultiplier} rate Ã— ${routeRatioValue} ratio + ${boardingPoints} boarding = ${basePP + boardingPoints} PP`);
            
            return basePP + boardingPoints;
        }

        function calculateMiles(distance, classCode, routeType) {
            const classData = routeType === 'domestic' ? domesticClassData : internationalClassData;
            const classInfo = classData[classCode];
            
            if (!classInfo) return 0;
            
            // ANA Miles formula: Basic sector mileage Ã— Accrual rate for booking class
            return Math.floor(distance * classInfo.rate);
        }

        // Main calculation function
        function calculateTrip() {
            console.log('calculateTrip function called');
            
            try {
                const flights = document.querySelectorAll('.flight-entry');
                const currentStatus = document.getElementById('current-status').value;
                const currentPP = parseInt(document.getElementById('current-pp').value) || 0;
                
                console.log(`Found ${flights.length} flights`);
                console.log(`Current status: ${currentStatus}`);
                
                let totalPP = 0;
                let totalMiles = 0;
                let totalCost = 0;
                let validFlights = 0;
                let hasInvalidClass = false;

                flights.forEach((flight, index) => {
                    console.log(`Processing flight ${index + 1}`);
                    
                    const from = flight.querySelector('.from-airport').value;
                    const to = flight.querySelector('.to-airport').value;
                    const classCode = flight.querySelector('.booking-class').value;
                    const ticketPrice = parseInt(flight.querySelector('.ticket-price').value) || 0;
                    const multiplier = parseInt(flight.querySelector('.trip-multiplier').value) || 1;

                    console.log(`Flight ${index + 1}: ${from} -> ${to}, class: ${classCode}, price: ${ticketPrice || 'none'}, multiplier: ${multiplier}`);

                    if (from && to && classCode) {
                        let distance = getDistance(from, to);
                        
                        if (distance === 0) {
                            distance = estimateDistance(from, to);
                            console.log(`Using estimated distance: ${distance}`);
                        }
                        
                        console.log(`Distance: ${distance}`);
                        
                        if (distance > 0) {
                            const routeType = isInternational(from, to) ? 'international' : 'domestic';
                            console.log(`Route type: ${routeType}`);
                            
                            const classData = routeType === 'domestic' ? domesticClassData : internationalClassData;
                            
                            if (!classData[classCode]) {
                                console.log(`Invalid class code ${classCode} for ${routeType} route`);
                                hasInvalidClass = true;
                                return;
                            }
                            
                            validFlights++;
                            
                            // Calculate base PP and miles per segment
                            const basePP = calculatePP(distance, classCode, routeType, from, to);
                            const baseMiles = calculateMiles(distance, classCode, routeType);
                            
                            console.log(`Base PP: ${basePP}, Base Miles: ${baseMiles}`);
                            
                            // Apply status bonus only to miles (not PP)
                            const statusMultiplier = 1 + statusBonus[currentStatus];
                            const finalPP = basePP * multiplier; // PP doesn't get status bonus
                            const finalMiles = Math.floor(baseMiles * statusMultiplier * multiplier);
                            
                            console.log(`Final PP: ${finalPP}, Final Miles: ${finalMiles}`);
                            
                            totalPP += finalPP;
                            totalMiles += finalMiles;
                            if (ticketPrice > 0) {
                                totalCost += (ticketPrice * multiplier);
                            }
                        }
                    }
                });

                console.log(`Valid flights: ${validFlights}, Total PP: ${totalPP}, Total Cost: ${totalCost || 'No price data'}`);

                if (hasInvalidClass) {
                    alert('é¸æŠã—ãŸäºˆç´„ã‚¯ãƒ©ã‚¹ãŒã“ã®ãƒ«ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ã§ã¯ç„¡åŠ¹ã§ã™ã€‚ç©ºæ¸¯ã‚’å†é¸æŠã—ã¦äºˆç´„ã‚¯ãƒ©ã‚¹ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ã€‚');
                    return;
                }

                if (validFlights === 0) {
                    alert('æœ‰åŠ¹ãªãƒ•ãƒ©ã‚¤ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆå‡ºç™ºãƒ»åˆ°ç€ç©ºæ¸¯ã€äºˆç´„ã‚¯ãƒ©ã‚¹ã‚’é¸æŠï¼‰');
                    return;
                }

                // Update display
                document.getElementById('total-pp').textContent = totalPP.toLocaleString();
                document.getElementById('total-miles').textContent = totalMiles.toLocaleString();
                
                // Show different results based on whether price was entered
                const resultsGrid = document.querySelector('.results-grid');
                
                if (totalCost > 0) {
                    resultsGrid.classList.remove('no-price');
                    const ppEfficiency = (totalPP / totalCost * 1000);
                    
                    document.getElementById('total-cost').textContent = `Â¥${totalCost.toLocaleString()}`;
                    document.getElementById('pp-efficiency').textContent = `${ppEfficiency.toFixed(1)} PP/Â¥1000`;
                    
                    document.querySelectorAll('.result-item').forEach(item => item.style.display = 'flex');
                    document.querySelector('.result-highlight').style.display = 'block';
                    
                    // Efficiency rating
                    let efficiencyClass, efficiencyText, efficiencyPercent;
                    if (ppEfficiency >= 20) {
                        efficiencyClass = 'efficiency-excellent';
                        efficiencyText = 'ğŸ† æ¥µã‚ã¦å„ªç§€ãªåŠ¹ç‡';
                        efficiencyPercent = 95;
                    } else if (ppEfficiency >= 15) {
                        efficiencyClass = 'efficiency-excellent';
                        efficiencyText = 'ğŸ† å„ªç§€ãªåŠ¹ç‡';
                        efficiencyPercent = 85;
                    } else if (ppEfficiency >= 10) {
                        efficiencyClass = 'efficiency-good';
                        efficiencyText = 'ğŸ‘ è‰¯å¥½ãªåŠ¹ç‡';
                        efficiencyPercent = 70;
                    } else if (ppEfficiency >= 5) {
                        efficiencyClass = 'efficiency-average';
                        efficiencyText = 'ğŸ“Š å¹³å‡çš„ãªåŠ¹ç‡';
                        efficiencyPercent = 50;
                    } else {
                        efficiencyClass = 'efficiency-poor';
                        efficiencyText = 'âš ï¸ åŠ¹ç‡æ”¹å–„æ¨å¥¨';
                        efficiencyPercent = 25;
                    }

                    const efficiencyBar = document.getElementById('efficiency-bar');
                    const efficiencyRating = document.getElementById('efficiency-rating');
                    
                    if (efficiencyBar && efficiencyRating) {
                        efficiencyBar.className = `efficiency-fill ${efficiencyClass}`;
                        efficiencyBar.style.width = `${efficiencyPercent}%`;
                        efficiencyRating.textContent = efficiencyText;
                    }
                } else {
                    resultsGrid.classList.add('no-price');
                    document.querySelector('.result-item:nth-child(3)').style.display = 'none';
                    document.querySelector('.result-item:nth-child(4)').style.display = 'none';
                    document.querySelector('.result-highlight').style.display = 'none';
                }

                // Status progress
                updateStatusProgress(currentPP + totalPP);

                // Show results
                const resultsElement = document.getElementById('trip-results');
                if (resultsElement) {
                    resultsElement.style.display = 'block';
                    resultsElement.scrollIntoView({ behavior: 'smooth' });
                }
                
                console.log('Calculation completed successfully');
                
            } catch (error) {
                console.error('Calculation error:', error);
                alert(`è¨ˆç®—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
            }
        }

        function updateStatusProgress(totalPP) {
            const thresholds = { bronze: 30000, platinum: 50000, diamond: 100000 };
            let targetStatus, targetPP, progress;

            if (totalPP < thresholds.bronze) {
                targetStatus = 'ãƒ–ãƒ­ãƒ³ã‚ºã‚µãƒ¼ãƒ“ã‚¹';
                targetPP = thresholds.bronze;
                progress = (totalPP / targetPP) * 100;
            } else if (totalPP < thresholds.platinum) {
                targetStatus = 'ãƒ—ãƒ©ãƒãƒŠã‚µãƒ¼ãƒ“ã‚¹';
                targetPP = thresholds.platinum;
                progress = (totalPP / targetPP) * 100;
            } else if (totalPP < thresholds.diamond) {
                targetStatus = 'ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹';
                targetPP = thresholds.diamond;
                progress = (totalPP / targetPP) * 100;
            } else {
                targetStatus = 'ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰é”æˆæ¸ˆã¿';
                targetPP = thresholds.diamond;
                progress = 100;
            }

            const circle = document.getElementById('progress-circle');
            const text = document.getElementById('progress-percent');
            const statusText = document.getElementById('status-text');
            
            const circumference = 251.2;
            const offset = circumference - (progress / 100) * circumference;
            
            circle.style.strokeDashoffset = offset;
            text.textContent = `${Math.round(progress)}%`;
            statusText.textContent = `${targetStatus}ã¾ã§ ${(targetPP - totalPP).toLocaleString()} PP`;

            // Recommendations
            const recommendations = document.getElementById('status-recommendations');
            const remaining = targetPP - totalPP;
            
            if (remaining > 0) {
                // Using HND-OKA with é‹è³ƒ5 (VALUE) - includes 400 boarding points per segment
                // 984 distance * 0.75 rate * 2 route ratio + 400 boarding points = 1,876 PP per segment
                // Round trip = 1,876 * 2 = 3,752 PP
                const ppPerTrip = 3752; // Much better PP efficiency with boarding points
                const costPerTrip = 60000; // VALUE fares cost more than SUPER VALUE
                recommendations.innerHTML = `
                    <div style="background: white; padding: 12px; border-radius: 6px; border: 1px solid var(--ana-border); font-size: 12px;">
                        <strong>å¿…è¦PP:</strong> ${remaining.toLocaleString()} PP<br>
                        <strong>HND-OKAå¾€å¾© (é‹è³ƒ5 VALUE)ãªã‚‰:</strong> ç´„${Math.ceil(remaining / ppPerTrip)}å›<br>
                        <strong>æ¦‚ç®—è²»ç”¨:</strong> Â¥${(Math.ceil(remaining / ppPerTrip) * costPerTrip).toLocaleString()}
                    </div>
                `;
            } else {
                recommendations.innerHTML = `
                    <div style="background: var(--ana-light-blue); padding: 12px; border-radius: 6px; font-size: 12px;">
                        ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼<br>
                        ${targetStatus}ã®æ¡ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã™
                    </div>
                `;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeAirports();
            
            // Close modal when clicking outside
            document.getElementById('contact-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeContactForm();
                }
            });
        });
    </script>
</body>
</html>